<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binning & Smoothing - Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100">
    <div class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">
                    Binning & Smoothing - Interaktivna Demonstracija
                </h1>
                <p class="text-gray-600">
                    Unesite podatke i izaberite metodu binning-a i smoothing-a
                </p>
            </div>

            <!-- Input Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <!-- Data Input -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üìä Unos podataka</h2>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Unesite podatke (CSV format):
                    </label>
                    <textarea 
                        id="dataInput" 
                        class="w-full h-24 p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none font-mono text-sm"
                        placeholder="21, 8, 34, 4, 25, 21, 15, 28, 24"
                    >21, 8, 34, 4, 25, 21, 15, 28, 24</textarea>
                    
                    <div class="mt-4 grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                Broj binova:
                            </label>
                            <input 
                                type="number" 
                                id="numBins" 
                                value="3" 
                                min="2" 
                                max="10"
                                class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                            >
                        </div>
                        <div class="flex items-end">
                            <button 
                                onclick="processData()" 
                                class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl"
                            >
                                üîÑ Procesiraj podatke
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üìà Statistika</h2>
                    <div id="statistics" class="space-y-3">
                        <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                            <p class="text-xs text-blue-600 font-semibold">Broj podataka</p>
                            <p class="text-2xl font-bold text-blue-700" id="dataCount">-</p>
                        </div>
                        <div class="bg-green-50 rounded-lg p-3 border border-green-200">
                            <p class="text-xs text-green-600 font-semibold">Min vrijednost</p>
                            <p class="text-2xl font-bold text-green-700" id="minValue">-</p>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
                            <p class="text-xs text-purple-600 font-semibold">Max vrijednost</p>
                            <p class="text-2xl font-bold text-purple-700" id="maxValue">-</p>
                        </div>
                        <div class="bg-orange-50 rounded-lg p-3 border border-orange-200">
                            <p class="text-xs text-orange-600 font-semibold">Domen</p>
                            <p class="text-2xl font-bold text-orange-700" id="domain">-</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Method Selection -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Binning Method -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üóÇÔ∏è Metoda Binning-a</h2>
                    <div class="space-y-3">
                        <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition-all">
                            <input type="radio" name="binning" value="width" checked class="w-5 h-5 text-blue-600" onchange="processData()">
                            <div class="ml-3">
                                <p class="font-semibold text-gray-800">Equal Width (Iste ≈°irine)</p>
                                <p class="text-sm text-gray-600">Binovi imaju istu ≈°irinu</p>
                            </div>
                        </label>
                        <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 transition-all">
                            <input type="radio" name="binning" value="frequency" class="w-5 h-5 text-green-600" onchange="processData()">
                            <div class="ml-3">
                                <p class="font-semibold text-gray-800">Equal Frequency (Iste frekvencije)</p>
                                <p class="text-sm text-gray-600">Binovi imaju isti broj elemenata</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Smoothing Method -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚ú® Metoda Smoothing-a</h2>
                    <div class="space-y-3">
                        <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition-all">
                            <input type="radio" name="smoothing" value="mean" checked class="w-5 h-5 text-purple-600" onchange="processData()">
                            <div class="ml-3">
                                <p class="font-semibold text-gray-800">By Mean (Srednja vrijednost)</p>
                                <p class="text-sm text-gray-600">Zamjena sa prosjeƒçnom vrijedno≈°ƒáu bin-a</p>
                            </div>
                        </label>
                        <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-orange-500 transition-all">
                            <input type="radio" name="smoothing" value="boundaries" class="w-5 h-5 text-orange-600" onchange="processData()">
                            <div class="ml-3">
                                <p class="font-semibold text-gray-800">By Boundaries (Granice)</p>
                                <p class="text-sm text-gray-600">Zamjena sa najbli≈æom granicom bin-a</p>
                            </div>
                        </label>
                        <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-indigo-500 transition-all">
                            <input type="radio" name="smoothing" value="median" class="w-5 h-5 text-indigo-600" onchange="processData()">
                            <div class="ml-3">
                                <p class="font-semibold text-gray-800">By Median (Medijana)</p>
                                <p class="text-sm text-gray-600">Zamjena sa medijanom bin-a</p>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Bins Table -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üóÉÔ∏è Binning rezultati</h2>
                    <div id="binsTable" class="overflow-x-auto"></div>
                </div>

                <!-- Smoothing Table -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚ú® Smoothing rezultati</h2>
                    <div id="smoothingTable" class="overflow-x-auto"></div>
                </div>
            </div>

            <!-- Visualization -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üìä Vizualizacija</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-sm font-semibold text-gray-600 mb-2">Originalni podaci</h3>
                        <canvas id="originalChart"></canvas>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold text-gray-600 mb-2">Nakon smoothing-a</h3>
                        <canvas id="smoothedChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center text-gray-500 text-sm">
                <p>Ma≈°insko uƒçenje i inteligentno upravljanje | Red. prof. dr Samim Konjicija</p>
                <p class="mt-1">Sarajevo, 2025. godine</p>
            </div>
        </div>
    </div>

    <script>
        let originalChart, smoothedChart;

        function processData() {
            // Get input
            const input = document.getElementById('dataInput').value;
            const numBins = parseInt(document.getElementById('numBins').value);
            const binningMethod = document.querySelector('input[name="binning"]:checked').value;
            const smoothingMethod = document.querySelector('input[name="smoothing"]:checked').value;

            // Parse data
            const data = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
            
            if (data.length === 0) {
                alert('Unesite validne podatke!');
                return;
            }

            const sortedData = [...data].sort((a, b) => a - b);
            
            // Update statistics
            document.getElementById('dataCount').textContent = data.length;
            document.getElementById('minValue').textContent = Math.min(...data);
            document.getElementById('maxValue').textContent = Math.max(...data);
            document.getElementById('domain').textContent = `[${Math.min(...data)}, ${Math.max(...data)}]`;

            // Create bins
            let bins;
            if (binningMethod === 'width') {
                bins = createEqualWidthBins(sortedData, numBins);
            } else {
                bins = createEqualFrequencyBins(sortedData, numBins);
            }

            // Apply smoothing
            const smoothedBins = applySmoothing(bins, smoothingMethod);

            // Display results
            displayBinsTable(bins);
            displaySmoothingTable(bins, smoothedBins);
            
            // Update charts
            updateCharts(sortedData, bins, smoothedBins);
        }

        function createEqualWidthBins(data, numBins) {
            const min = Math.min(...data);
            const max = Math.max(...data);
            const width = (max - min) / numBins;
            
            const bins = [];
            for (let i = 0; i < numBins; i++) {
                const start = min + i * width;
                const end = i === numBins - 1 ? max : start + width;
                const values = data.filter(x => x >= start && x < end || (i === numBins - 1 && x === end));
                bins.push({
                    name: `Bin ${i + 1}`,
                    range: `[${start.toFixed(1)}, ${end.toFixed(1)}${i === numBins - 1 ? ']' : ')'}`,
                    values: values
                });
            }
            return bins;
        }

        function createEqualFrequencyBins(data, numBins) {
            const binSize = Math.ceil(data.length / numBins);
            const bins = [];
            
            for (let i = 0; i < numBins; i++) {
                const start = i * binSize;
                const end = Math.min((i + 1) * binSize, data.length);
                const values = data.slice(start, end);
                bins.push({
                    name: `Bin ${i + 1}`,
                    range: '-',
                    values: values
                });
            }
            return bins;
        }

        function applySmoothing(bins, method) {
            return bins.map(bin => {
                if (bin.values.length === 0) return { ...bin, smoothed: [] };
                
                let smoothed;
                if (method === 'mean') {
                    const mean = bin.values.reduce((a, b) => a + b, 0) / bin.values.length;
                    smoothed = bin.values.map(() => Math.round(mean));
                } else if (method === 'boundaries') {
                    const min = Math.min(...bin.values);
                    const max = Math.max(...bin.values);
                    smoothed = bin.values.map(v => {
                        const distToMin = Math.abs(v - min);
                        const distToMax = Math.abs(v - max);
                        return distToMin <= distToMax ? min : max;
                    });
                } else if (method === 'median') {
                    const sorted = [...bin.values].sort((a, b) => a - b);
                    const median = sorted[Math.floor(sorted.length / 2)];
                    smoothed = bin.values.map(() => median);
                }
                
                return { ...bin, smoothed: smoothed };
            });
        }

        function displayBinsTable(bins) {
            const html = `
                <table class="w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 text-left font-semibold">Bin</th>
                            <th class="px-4 py-2 text-left font-semibold">Opseg</th>
                            <th class="px-4 py-2 text-left font-semibold">Podaci</th>
                            <th class="px-4 py-2 text-center font-semibold">Broj</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${bins.map((bin, i) => `
                            <tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                                <td class="px-4 py-2 font-semibold text-blue-700">${bin.name}</td>
                                <td class="px-4 py-2 text-gray-600">${bin.range}</td>
                                <td class="px-4 py-2 font-mono text-gray-800">${bin.values.join(', ')}</td>
                                <td class="px-4 py-2 text-center font-bold text-gray-700">${bin.values.length}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('binsTable').innerHTML = html;
        }

        function displaySmoothingTable(bins, smoothedBins) {
            const html = `
                <table class="w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 text-left font-semibold">Bin</th>
                            <th class="px-4 py-2 text-left font-semibold">Original</th>
                            <th class="px-4 py-2 text-left font-semibold">Izglaƒëeni</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${smoothedBins.map((bin, i) => `
                            <tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                                <td class="px-4 py-2 font-semibold text-purple-700">${bin.name}</td>
                                <td class="px-4 py-2 font-mono text-gray-600">${bin.values.join(', ')}</td>
                                <td class="px-4 py-2 font-mono font-bold text-green-700">${bin.smoothed.join(', ')}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('smoothingTable').innerHTML = html;
        }

        function updateCharts(originalData, bins, smoothedBins) {
            // Original data chart
            const originalCtx = document.getElementById('originalChart').getContext('2d');
            if (originalChart) originalChart.destroy();
            
            originalChart = new Chart(originalCtx, {
                type: 'bar',
                data: {
                    labels: originalData.map((_, i) => i + 1),
                    datasets: [{
                        label: 'Originalni podaci',
                        data: originalData,
                        backgroundColor: 'rgba(59, 130, 246, 0.7)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });

            // Smoothed data chart
            const smoothedData = smoothedBins.flatMap(bin => bin.smoothed);
            const smoothedCtx = document.getElementById('smoothedChart').getContext('2d');
            if (smoothedChart) smoothedChart.destroy();
            
            smoothedChart = new Chart(smoothedCtx, {
                type: 'bar',
                data: {
                    labels: smoothedData.map((_, i) => i + 1),
                    datasets: [{
                        label: 'Izglaƒëeni podaci',
                        data: smoothedData,
                        backgroundColor: 'rgba(34, 197, 94, 0.7)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        // Process data on load
        window.onload = () => processData();
    </script>
</body>
</html>