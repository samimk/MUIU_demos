<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uzorkovanje podataka - Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .data-item {
            transition: all 0.3s ease;
        }
        .data-item.selected {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .data-item.removed {
            opacity: 0.3;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100">
    <div class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">
                    Uzorkovanje podataka - Interaktivna Demonstracija
                </h1>
                <p class="text-gray-600">
                    Vizualizacija razliƒçitih metoda uzorkovanja
                </p>
            </div>

            <!-- Configuration -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚öôÔ∏è Konfiguracija</h2>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            Populacija (CSV format - ID:Klasa):
                        </label>
                        <textarea 
                            id="populationInput" 
                            class="w-full h-32 p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none font-mono text-sm"
                            placeholder="1:A, 2:B, 3:A, 4:C, ..."
                        >1:A, 2:B, 3:A, 4:C, 5:B, 6:A, 7:B, 8:C, 9:A, 10:B, 11:A, 12:C, 13:B, 14:A, 15:C, 16:B, 17:A, 18:B, 19:C, 20:A, 21:B, 22:A, 23:C, 24:B, 25:A, 26:C, 27:B, 28:A, 29:B, 30:C, 31:A, 32:B, 33:A, 34:C, 35:B, 36:A, 37:B, 38:C, 39:A, 40:B, 41:A, 42:C, 43:B, 44:A, 45:C, 46:B, 47:A, 48:B, 49:C, 50:A</textarea>
                        <div class="flex gap-3 mt-2">
                            <button 
                                onclick="loadPopulationFromInput()" 
                                class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-700 transition-all"
                            >
                                üì• Uƒçitaj populaciju
                            </button>
                            <button 
                                onclick="generateRandomPopulation()" 
                                class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-purple-700 transition-all"
                            >
                                üé≤ Generi≈°i random
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                Veliƒçina uzorka (n):
                            </label>
                            <input 
                                type="number" 
                                id="sampleSize" 
                                value="10" 
                                min="1"
                                max="100"
                                class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                            >
                        </div>
                        <div class="flex items-end">
                            <button 
                                onclick="resetSample()" 
                                class="w-full bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-all shadow-lg"
                            >
                                üîÑ Reset uzorka
                            </button>
                        </div>
                    </div>

                    <div class="mt-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            Metoda uzorkovanja:
                        </label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition-all">
                                <input type="radio" name="method" value="srswor" checked class="w-5 h-5 text-blue-600">
                                <div class="ml-3">
                                    <p class="font-semibold text-gray-800">SRSWOR (Without Replacement)</p>
                                    <p class="text-xs text-gray-600">Bez zamjene - svaka instanca samo jednom</p>
                                </div>
                            </label>
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 transition-all">
                                <input type="radio" name="method" value="srswr" class="w-5 h-5 text-green-600">
                                <div class="ml-3">
                                    <p class="font-semibold text-gray-800">SRSWR (With Replacement)</p>
                                    <p class="text-xs text-gray-600">Sa zamjenom - mo≈æe se ponavljati</p>
                                </div>
                            </label>
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition-all">
                                <input type="radio" name="method" value="stratified" class="w-5 h-5 text-purple-600">
                                <div class="ml-3">
                                    <p class="font-semibold text-gray-800">Stratified Sampling</p>
                                    <p class="text-xs text-gray-600">Odr≈æava proporcije klasa</p>
                                </div>
                            </label>
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-orange-500 transition-all">
                                <input type="radio" name="method" value="systematic" class="w-5 h-5 text-orange-600">
                                <div class="ml-3">
                                    <p class="font-semibold text-gray-800">Systematic Sampling</p>
                                    <p class="text-xs text-gray-600">Svaka k-ta instanca</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button 
                            onclick="sampleOnce()" 
                            class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all shadow-lg"
                        >
                            ‚ñ∂Ô∏è Uzmi 1 instancu
                        </button>
                        <button 
                            onclick="sampleAll()" 
                            class="flex-1 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all shadow-lg"
                        >
                            ‚è© Uzmi sve (n instanci)
                        </button>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üìä Statistika</h2>
                    <div class="space-y-3">
                        <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                            <p class="text-xs text-blue-600 font-semibold">Populacija (N)</p>
                            <p class="text-2xl font-bold text-blue-700" id="statPopulation">50</p>
                        </div>
                        <div class="bg-green-50 rounded-lg p-3 border border-green-200">
                            <p class="text-xs text-green-600 font-semibold">Uzorak (n)</p>
                            <p class="text-2xl font-bold text-green-700" id="statSample">0 / 10</p>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
                            <p class="text-xs text-purple-600 font-semibold">Preostalo</p>
                            <p class="text-2xl font-bold text-purple-700" id="statRemaining">50</p>
                        </div>
                        <div class="bg-orange-50 rounded-lg p-3 border border-orange-200">
                            <p class="text-xs text-orange-600 font-semibold">Duplikati</p>
                            <p class="text-2xl font-bold text-orange-700" id="statDuplicates">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visualization -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Population -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üóÉÔ∏è Populacija</h2>
                    <div id="population" class="grid grid-cols-10 gap-2 max-h-96 overflow-y-auto p-2">
                    </div>
                </div>

                <!-- Sample -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚úÖ Uzorak</h2>
                    <div id="sample" class="grid grid-cols-10 gap-2 max-h-96 overflow-y-auto p-2">
                    </div>
                </div>
            </div>

            <!-- Distribution Chart -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üìä Distribucija klasa</h2>
                <canvas id="distributionChart"></canvas>
            </div>

            <!-- Explanation -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üìö Obja≈°njenje metoda</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500">
                        <h3 class="font-bold text-blue-900 mb-2">SRSWOR (Without Replacement)</h3>
                        <p class="text-sm text-blue-800 mb-2"><strong>Kako radi:</strong></p>
                        <ul class="text-sm text-blue-700 space-y-1 mb-3">
                            <li>‚Ä¢ Svaka instanca mo≈æe biti izabrana samo jednom</li>
                            <li>‚Ä¢ Nakon izbora, instanca se uklanja iz skupa</li>
                            <li>‚Ä¢ n ‚â§ N (ne mo≈æe≈° uzeti vi≈°e nego ≈°to ima≈°)</li>
                        </ul>
                        <p class="text-sm text-blue-800"><strong>Koristi se za:</strong> Standard train/test split, cross-validation</p>
                    </div>

                    <div class="bg-green-50 rounded-lg p-4 border-l-4 border-green-500">
                        <h3 class="font-bold text-green-900 mb-2">SRSWR (With Replacement)</h3>
                        <p class="text-sm text-green-800 mb-2"><strong>Kako radi:</strong></p>
                        <ul class="text-sm text-green-700 space-y-1 mb-3">
                            <li>‚Ä¢ Ista instanca mo≈æe biti izabrana vi≈°e puta</li>
                            <li>‚Ä¢ Nakon izbora, instanca se vraƒáa u skup</li>
                            <li>‚Ä¢ n mo≈æe biti > N</li>
                        </ul>
                        <p class="text-sm text-green-800"><strong>Koristi se za:</strong> Bootstrap, Bagging, Random Forest</p>
                    </div>

                    <div class="bg-purple-50 rounded-lg p-4 border-l-4 border-purple-500">
                        <h3 class="font-bold text-purple-900 mb-2">Stratified Sampling</h3>
                        <p class="text-sm text-purple-800 mb-2"><strong>Kako radi:</strong></p>
                        <ul class="text-sm text-purple-700 space-y-1 mb-3">
                            <li>‚Ä¢ Dijeli populaciju u grupe (strata)</li>
                            <li>‚Ä¢ Uzorkuje proporcionalno iz svake grupe</li>
                            <li>‚Ä¢ Odr≈æava distribuciju klasa</li>
                        </ul>
                        <p class="text-sm text-purple-800"><strong>Koristi se za:</strong> Nebalansirani dataseti, klasifikacija</p>
                    </div>

                    <div class="bg-orange-50 rounded-lg p-4 border-l-4 border-orange-500">
                        <h3 class="font-bold text-orange-900 mb-2">Systematic Sampling</h3>
                        <p class="text-sm text-orange-800 mb-2"><strong>Kako radi:</strong></p>
                        <ul class="text-sm text-orange-700 space-y-1 mb-3">
                            <li>‚Ä¢ Izraƒçuna interval k = N/n</li>
                            <li>‚Ä¢ Uzima svaku k-tu instancu</li>
                            <li>‚Ä¢ Poƒçinje od random start pozicije</li>
                        </ul>
                        <p class="text-sm text-orange-800"><strong>Koristi se za:</strong> Brzo uzorkovanje, kvalitetna kontrola</p>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center text-gray-500 text-sm">
                <p>Ma≈°insko uƒçenje i inteligentno upravljanje | Red. prof. dr Samim Konjicija</p>
                <p class="mt-1">Sarajevo, 2025. godine</p>
            </div>
        </div>
    </div>

    <script>
        let population = [];
        let sample = [];
        let availablePopulation = [];
        let distributionChart;
        let systematicIndex = 0;

        const classes = ['A', 'B', 'C'];
        const classColors = {
            'A': { bg: 'bg-blue-500', border: 'border-blue-700' },
            'B': { bg: 'bg-green-500', border: 'border-green-700' },
            'C': { bg: 'bg-purple-500', border: 'border-purple-700' }
        };

        function loadPopulationFromInput() {
            const input = document.getElementById('populationInput').value;
            const n = parseInt(document.getElementById('sampleSize').value);
            
            const items = input.split(',').map(item => item.trim());
            population = [];
            
            for (const item of items) {
                const parts = item.split(':');
                if (parts.length === 2) {
                    const id = parseInt(parts[0].trim());
                    const cls = parts[1].trim();
                    if (!isNaN(id) && classes.includes(cls)) {
                        population.push({ id: id, class: cls, count: 0 });
                    }
                }
            }
            
            if (population.length === 0) {
                alert('Nema validnih podataka! Format: ID:Klasa (npr. 1:A, 2:B, 3:C)');
                generateRandomPopulation();
                return;
            }
            
            const N = population.length;
            
            if (n > N) {
                const method = document.querySelector('input[name="method"]:checked').value;
                if (method === 'srswor') {
                    alert('Za SRSWOR metodu, veliƒçina uzorka (n) ne mo≈æe biti veƒáa od populacije (N)! Smanjujem n na ' + N);
                    document.getElementById('sampleSize').value = N;
                }
            }
            
            availablePopulation = [...population];
            sample = [];
            systematicIndex = 0;
            
            renderPopulation();
            renderSample();
            updateStatistics();
            updateChart();
        }

        function generateRandomPopulation() {
            const N = 30 + Math.floor(Math.random() * 30);
            let populationText = '';
            
            for (let i = 1; i <= N; i++) {
                const cls = classes[Math.floor(Math.random() * classes.length)];
                populationText += `${i}:${cls}`;
                if (i < N) populationText += ', ';
            }
            
            document.getElementById('populationInput').value = populationText;
            loadPopulationFromInput();
        }

        function resetSample() {
            availablePopulation = [...population];
            sample = [];
            systematicIndex = 0;
            
            renderPopulation();
            renderSample();
            updateStatistics();
            updateChart();
        }

        function renderPopulation() {
            const container = document.getElementById('population');
            container.innerHTML = population.map(item => {
                const colors = classColors[item.class];
                const isRemoved = !availablePopulation.find(p => p.id === item.id);
                return `
                    <div class="data-item ${isRemoved ? 'removed' : ''} ${colors.bg} ${colors.border} border-2 rounded-lg p-3 text-white text-center font-bold">
                        ${item.id}
                        <div class="text-xs">${item.class}</div>
                    </div>
                `;
            }).join('');
        }

        function renderSample() {
            const container = document.getElementById('sample');
            if (sample.length === 0) {
                container.innerHTML = '<div class="col-span-10 text-center text-gray-400 py-8">Uzorak je prazan</div>';
                return;
            }
            
            container.innerHTML = sample.map(item => {
                const colors = classColors[item.class];
                const countBadge = item.count > 1 ? `<div class="absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">${item.count}</div>` : '';
                return `
                    <div class="relative data-item ${colors.bg} ${colors.border} border-2 rounded-lg p-3 text-white text-center font-bold">
                        ${countBadge}
                        ${item.id}
                        <div class="text-xs">${item.class}</div>
                    </div>
                `;
            }).join('');
        }

        function updateStatistics() {
            const N = population.length;
            const n = parseInt(document.getElementById('sampleSize').value);
            const currentSample = sample.reduce((acc, item) => acc + item.count, 0);
            const remaining = availablePopulation.length;
            
            const duplicates = sample.reduce((acc, item) => acc + (item.count > 1 ? item.count - 1 : 0), 0);
            
            document.getElementById('statPopulation').textContent = N;
            document.getElementById('statSample').textContent = `${currentSample} / ${n}`;
            document.getElementById('statRemaining').textContent = remaining;
            document.getElementById('statDuplicates').textContent = duplicates;
        }

        function updateChart() {
            const popCounts = { A: 0, B: 0, C: 0 };
            const sampleCounts = { A: 0, B: 0, C: 0 };
            
            population.forEach(item => popCounts[item.class]++);
            sample.forEach(item => sampleCounts[item.class] += item.count);
            
            const ctx = document.getElementById('distributionChart').getContext('2d');
            if (distributionChart) distributionChart.destroy();
            
            distributionChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Klasa A', 'Klasa B', 'Klasa C'],
                    datasets: [
                        {
                            label: 'Populacija',
                            data: [popCounts.A, popCounts.B, popCounts.C],
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 2
                        },
                        {
                            label: 'Uzorak',
                            data: [sampleCounts.A, sampleCounts.B, sampleCounts.C],
                            backgroundColor: 'rgba(34, 197, 94, 0.7)',
                            borderColor: 'rgba(34, 197, 94, 1)',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function sampleOnce() {
            const method = document.querySelector('input[name="method"]:checked').value;
            const n = parseInt(document.getElementById('sampleSize').value);
            const currentCount = sample.reduce((acc, item) => acc + item.count, 0);
            
            if (currentCount >= n) {
                alert('Uzorak je veƒá popunjen!');
                return;
            }
            
            if (method === 'srswor') {
                srswor();
            } else if (method === 'srswr') {
                srswr();
            } else if (method === 'stratified') {
                stratifiedSampleOne();
            } else if (method === 'systematic') {
                systematicSampleOne();
            }
            
            renderPopulation();
            renderSample();
            updateStatistics();
            updateChart();
        }

        function sampleAll() {
            const method = document.querySelector('input[name="method"]:checked').value;
            const n = parseInt(document.getElementById('sampleSize').value);
            
            sample = [];
            availablePopulation = [...population];
            systematicIndex = 0;
            
            if (method === 'srswor') {
                for (let i = 0; i < n && availablePopulation.length > 0; i++) {
                    srswor();
                }
            } else if (method === 'srswr') {
                for (let i = 0; i < n; i++) {
                    srswr();
                }
            } else if (method === 'stratified') {
                stratifiedSampleAll();
            } else if (method === 'systematic') {
                systematicSampleAll();
            }
            
            renderPopulation();
            renderSample();
            updateStatistics();
            updateChart();
        }

        function srswor() {
            if (availablePopulation.length === 0) {
                alert('Nema vi≈°e dostupnih instanci!');
                return;
            }
            const randomIndex = Math.floor(Math.random() * availablePopulation.length);
            const selected = availablePopulation.splice(randomIndex, 1)[0];
            sample.push({ ...selected, count: 1 });
        }

        function srswr() {
            const randomIndex = Math.floor(Math.random() * population.length);
            const selected = population[randomIndex];
            const existing = sample.find(s => s.id === selected.id);
            if (existing) {
                existing.count++;
            } else {
                sample.push({ ...selected, count: 1 });
            }
        }

        function stratifiedSampleOne() {
            const availableClasses = classes.filter(cls => {
                const classItems = availablePopulation.filter(item => item.class === cls);
                return classItems.length > 0;
            });
            
            if (availableClasses.length === 0) {
                alert('Nema vi≈°e dostupnih instanci!');
                return;
            }
            
            const selectedClass = availableClasses[Math.floor(Math.random() * availableClasses.length)];
            const classItems = availablePopulation.filter(item => item.class === selectedClass);
            const randomIndex = Math.floor(Math.random() * classItems.length);
            const selected = classItems[randomIndex];
            
            const popIndex = availablePopulation.findIndex(item => item.id === selected.id);
            availablePopulation.splice(popIndex, 1);
            sample.push({ ...selected, count: 1 });
        }

        function stratifiedSampleAll() {
            const n = parseInt(document.getElementById('sampleSize').value);
            const classCounts = { A: 0, B: 0, C: 0 };
            population.forEach(item => classCounts[item.class]++);
            
            const totalPop = population.length;
            const samplePerClass = {
                A: Math.round(n * classCounts.A / totalPop),
                B: Math.round(n * classCounts.B / totalPop),
                C: Math.round(n * classCounts.C / totalPop)
            };
            
            for (const cls of classes) {
                const classItems = availablePopulation.filter(item => item.class === cls);
                const numToSample = Math.min(samplePerClass[cls], classItems.length);
                
                for (let i = 0; i < numToSample; i++) {
                    const randomIndex = Math.floor(Math.random() * classItems.length);
                    const selected = classItems.splice(randomIndex, 1)[0];
                    const popIndex = availablePopulation.findIndex(item => item.id === selected.id);
                    availablePopulation.splice(popIndex, 1);
                    sample.push({ ...selected, count: 1 });
                }
            }
        }

        function systematicSampleOne() {
            const n = parseInt(document.getElementById('sampleSize').value);
            const N = population.length;
            const k = Math.floor(N / n);
            
            if (systematicIndex === 0) {
                systematicIndex = Math.floor(Math.random() * k);
            }
            
            if (systematicIndex < population.length) {
                const selected = population[systematicIndex];
                const popIndex = availablePopulation.findIndex(item => item.id === selected.id);
                if (popIndex !== -1) {
                    availablePopulation.splice(popIndex, 1);
                }
                sample.push({ ...selected, count: 1 });
                systematicIndex += k;
            }
        }

        function systematicSampleAll() {
            const n = parseInt(document.getElementById('sampleSize').value);
            const N = population.length;
            const k = Math.floor(N / n);
            const start = Math.floor(Math.random() * k);
            
            for (let i = start; i < N && sample.length < n; i += k) {
                const selected = population[i];
                const popIndex = availablePopulation.findIndex(item => item.id === selected.id);
                if (popIndex !== -1) {
                    availablePopulation.splice(popIndex, 1);
                }
                sample.push({ ...selected, count: 1 });
            }
        }

        window.onload = () => {
            loadPopulationFromInput();
        };
    </script>
</body>
</html>